<% content_for :title, "Child Benefit tax calculator" %>

<section id="content" role="main" class="group calculator-page">
  <header class="page-header group full-width">
    <hgroup class="full-width">
    <h1><span>Quick answer</span> Child Benefit tax calculator</h1>
    </hgroup>
    <a class="skip-to-related" href="#related">Not what you're looking for? â†“</a>
  </header>

  <article id="calculator" role="article">
    <div class="questions">
      <div class="inner">
        <p class="intro">Use the calculator to find out if you need to pay back any of your Child Benefit.</p>
        <%= form_tag("process_form", :method => :get) do %>
          <!-- hidden field to store the tax year so it can persist -->
          <input type="hidden" name="year" value="<%= params[:year] %>" />
          <!-- hidden field to store if we're showing extra income or not -->
          <input type="hidden" name="show_extra_income" value="<%= show_extra_income? %>" />

          <fieldset>
            <%= step(1, "Enter the number of children you:") %>
            <ul>
              <li>are currently claiming for</li>
              <li>have claimed for in the past</li>
              <li>expect to claim for in the future</li>
            </ul>
            <%= select_tag "children_count", options_for_select((1..10).collect{|n| [n,n]}) %>
          </fieldset>

          <fieldset>
            <%= step(2, "Enter the dates Child Benefit started and, if applicable, stopped.") %>
            <%= render "starting_children" %>
          </fieldset>

          <fieldset>
            <%= step(3, "To work out the Child benefit received during a tax year, choose a tax year.") %>
            <% ChildBenefitTaxCalculator::TAX_YEARS.each do |year, years| -%>
              <%= radio_button_tag "year", year %>&nbsp;<%= tax_year_label(years) %> 
            <% end -%>
          </fieldset>

          <fieldset id="adjusted_income">
            <%= step(4, "ANI") %>
            <%= text_field_tag "annual_net_income" %>
          </fieldset>

          <%= submit_tag("Get your estimate", { :class => "button" }) %>
        <% end %>
      </div><!-- end .inner -->
    </div><!-- end .questions -->
    <% if @calculator.can_calculate? -%>
    <aside class="results" id="results_box">
      <div class="inner">
        <h1>Results</h1>
        <%= render "results" %>
      </div><!-- end .inner -->
    </aside>
    <% end -%>
  </article><!-- end .thirds -->
</section>
